(function(){const KEY='abc_state';function g(){try{return JSON.parse(localStorage.getItem(KEY)||'{}')}catch(e){return{}}}function s(v){localStorage.setItem(KEY,JSON.stringify(v))}function info(){const st=g(),f=st.flags||{},u=f.proTrialUntil?new Date(f.proTrialUntil):null,n=new Date(),a=!!(f.proTrial&&u&&u>n),d=a?Math.max(0,Math.ceil((u-n)/86400000)):0;return{active:a,daysLeft:d,until:u}}function start(days=7){const st=g();st.flags=st.flags||{};const u=new Date(Date.now()+days*86400000);st.flags.proTrial=true;st.flags.proTrialUntil=u.toISOString();st.settings=st.settings||{};st.settings.plan='pro';s(st);banner()}function endIfExpired(){const st=g(),i=info();if(st.flags&&st.flags.proTrial&&!i.active){st.flags.proTrial=false;delete st.flags.proTrialUntil;st.settings=st.settings||{};if(st.settings.plan==='pro')st.settings.plan='free';s(st)}}function banner(){endIfExpired();const i=info();let el=document.getElementById('abc-trial-banner');if(!el){el=document.createElement('div');el.id='abc-trial-banner';el.className='abc-banner';document.body.appendChild(el)}if(i.active){el.innerHTML='<span class="abc-badge">Pro Trial</span><span>Trial ends in <strong>'+i.daysLeft+'</strong> day'+(i.daysLeft===1?'':'s')+'.</span><a href="../#pricing" class="abc-btn">See plans</a><button class="abc-btn" id="abc-hide-banner">Hide</button>'}else{el.innerHTML='<span class="abc-badge">New</span><span>Try <strong>Pro free</strong> for 7 days — no card required.</span><button class="abc-btn primary" id="abc-start-trial">Start 7‑day trial</button><button class="abc-btn" id="abc-hide-banner">Hide</button>';const b=el.querySelector('#abc-start-trial');if(b)b.addEventListener('click',()=>{start(7);alert('Pro trial started!')})}const h=el.querySelector('#abc-hide-banner');if(h)h.addEventListener('click',()=>{el.remove()})}function tour(){if(localStorage.getItem('abc_tour_done'))return;let ov=document.getElementById('abc-tour-overlay');if(!ov){ov=document.createElement('div');ov.id='abc-tour-overlay';ov.innerHTML='<div id="abc-tour"><h2>Welcome to ABC Center</h2><p>This quick tour shows you around.</p><div class="actions"><button id="abc-skip" class="abc-btn">Skip</button><button id="abc-next" class="abc-btn primary">Done</button></div></div>';document.body.appendChild(ov)}ov.style.display='block';setTimeout(()=>{ov.style.display='none';localStorage.setItem('abc_tour_done','1')},6000);const next=ov.querySelector('#abc-next'),skip=ov.querySelector('#abc-skip');next.onclick=()=>{ov.style.display='none';localStorage.setItem('abc_tour_done','1')};skip.onclick=()=>{ov.style.display='none';localStorage.setItem('abc_tour_done','1')}}document.addEventListener('DOMContentLoaded',()=>{const ov=document.createElement('div');ov.id='abc-tour-overlay';document.body.appendChild(ov);banner();tour();setInterval(endIfExpired,60000)});})();